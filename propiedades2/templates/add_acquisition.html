{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>{% block title %} Propiedades {% endblock %}</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
          integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'base.css' %}">
    <link href="{% static 'font-awesome/css/font-awesome.css' %}" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'js/jquery-3.1.1.min.js' %}">

</head>
{% include "base.html" %}
{% block content %}
    <body>
    <div class="container">
        <br>
        <div class="row">
            <div class="col-md-12">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12 mx-auto">
                            <h1>Agregar propiedad adquirida</h1>
                            <br>
                            <form action="" method="POST" enctype="multipart/form-data">{% csrf_token %}
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="card border-dark">
                                            <div class="card-header"><h2>Datos de propiedad</h2></div>
                                            <div class="card-body">
                                                <label>Nombre propiedad: *</label>
                                                {{ formAcquisition.name }}
                                                <p></p>
                                                <label>Número de rol: *</label>
                                                {{ formAcquisition.role_number }}
                                                <p></p>
                                                <label>Imagen de la propiedad:</label>
                                                {{ formAcquisition.image }}
                                                <p></p>
                                                <label>Uso de la propiedad: *</label>
                                                {{ formAcquisition.property_use }}
                                                <p></p>
                                                <label>Fecha de adquisición: *</label>
                                                {{ formAcquisition.acquisition_date }}
                                                <p></p>
                                                <label>Tipo de escritura: *</label>
                                                {{ formAcquisition.writing_data }}
                                                <p></p>
                                                <label>Número AASI.net: *</label>
                                                {{ formAcquisition.number_AASI }}
                                                <p></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card border-dark">
                                            <div class="card-header"><h2>Datos de dirección</h2></div>
                                            <div class="card-body">
                                                {{ formLocation.as_p }}
                                            </div>
                                        </div>
                                    </div>
                                    <br>
                                    <div class='col-md-12' style="padding: 30px;"><button id="enviarPropiedad" type="button"
                                            class="btn btn-success btn-lg btn-block">Aceptar
                                    </button></div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="card border-dark" id = 'Arquitecture' style="display: none">
                                            <div class="card-header"><h2>Datos de arquitectura</h2></div>
                                            <div class="card-body">
                                                {{ formArquitecture.as_p }}
                                                <div class="accordion" id="accordionArquitecture">
                                                    <div class="card border-dark">
                                                        <div class="card-header" id="headEx">
                                                            <h2 class="mb-0">
                                                                <button class="btn btn-outline-secondary btn-lg btn-block"
                                                                        type="button" data-toggle="collapse"
                                                                        data-target="#collapseEx" aria-expanded="false"
                                                                        aria-controls="collapseEx">
                                                                    Documento de expropiación municipal:
                                                                </button>
                                                            </h2>
                                                        </div>
                                                        <div id="collapseEx" class="collapse" aria-labelledby="headEx"
                                                             data-parent="#accordionArquitecture">
                                                            <div id="docEx">{{ formEx }}</div>
                                                        </div>
                                                    </div>
                                                    <div class="card border-dark">
                                                        <div class="card-header" id="headCIP">
                                                            <h2 class="mb-0">
                                                                <button class="btn btn-outline-secondary btn-lg btn-block"
                                                                        type="button" data-toggle="collapse"
                                                                        data-target="#collapseCIP" aria-expanded="true"
                                                                        aria-controls="collapseCIP">
                                                                    Documento CIP:
                                                                </button>
                                                            </h2>
                                                        </div>
                                                        <div id="collapseCIP" class="collapse" aria-labelledby="headCIP"
                                                             data-parent="#accordionArquitecture">
                                                            <div id="docCip">{{ formCip }}</div>
                                                        </div>
                                                    </div>
                                                    <div class="card border-dark">
                                                        <div class="card-header" id="headCn">
                                                            <h2 class="mb-0">
                                                                <button class="btn btn-outline-secondary btn-lg btn-block"
                                                                        type="button" data-toggle="collapse"
                                                                        data-target="#collapseCn" aria-expanded="true"
                                                                        aria-controls="collapseCn">
                                                                    Documento Certificado número:
                                                                </button>
                                                            </h2>
                                                        </div>
                                                        <div id="collapseCn" class="collapse" aria-labelledby="headCn"
                                                             data-parent="#accordionArquitecture">
                                                            <div id="docCn">{{ formCn }}</div>
                                                        </div>
                                                    </div>
                                                    <div class="card border-dark">
                                                        <div class="card-header" id="headBlue">
                                                            <h2 class="mb-0">
                                                                <button class="btn btn-outline-secondary btn-lg btn-block"
                                                                        type="button" data-toggle="collapse"
                                                                        data-target="#collapseBlue" aria-expanded="true"
                                                                        aria-controls="collapseBlue">
                                                                    Documento de planos:
                                                                </button>
                                                            </h2>
                                                        </div>
                                                        <div id="collapseBlue" class="collapse"
                                                             aria-labelledby="headBlue"
                                                             data-parent="#accordionArquitecture">
                                                            <div id="docBlue">{{ formBlue }}</div>
                                                        </div>
                                                    </div>
                                                    <div class="card border-dark">
                                                        <div class="card-header" id="headBuild">
                                                            <h2 class="mb-0">
                                                                <button class="btn btn-outline-secondary btn-lg btn-block"
                                                                        type="button" data-toggle="collapse"
                                                                        data-target="#collapseBuild"
                                                                        aria-expanded="true"
                                                                        aria-controls="collapseBuild">
                                                                    Documento permiso de edificación:
                                                                </button>
                                                            </h2>
                                                        </div>
                                                        <div id="collapseBuild" class="collapse"
                                                             aria-labelledby="headBuild"
                                                             data-parent="#accordionArquitecture">
                                                            <div id="docBuild">{{ formBuildP }}</div>
                                                        </div>
                                                    </div>
                                                    <div class="card border-dark">
                                                        <div class="card-header" id="headRM">
                                                            <h2 class="mb-0">
                                                                <button class="btn btn-outline-secondary btn-lg btn-block"
                                                                        type="button" data-toggle="collapse"
                                                                        data-target="#collapseRM" aria-expanded="true"
                                                                        aria-controls="collapseRM">
                                                                    Documento de recepción municipal:
                                                                </button>
                                                            </h2>
                                                        </div>
                                                        <div id="collapseRM" class="collapse" aria-labelledby="headRM"
                                                             data-parent="#accordionArquitecture">
                                                            <div id="docMR">{{ formMR }}</div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <button id="enviarArquitecture" type="button"
                                                        class="btn btn-success btn-lg btn-block">Aceptar
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="card border-dark" id="Notary" style="display: none">
                                            <div class="card-header"><h2>Datos de notaría</h2></div>
                                            <div class="card-body">{{ formNotary.as_p }}
                                                <div class="accordion" id="accordionNotary">
                                                    <div class="card border-dark">
                                                        <div class="card-header" id="headWr">
                                                            <h2 class="mb-0">
                                                                <button class="btn btn-outline-secondary btn-lg btn-block"
                                                                        type="button" data-toggle="collapse"
                                                                        data-target="#collapseOneN" aria-expanded="true"
                                                                        aria-controls="collapseOneN">
                                                                    Documento de escritura:
                                                                </button>
                                                            </h2>
                                                        </div>
                                                        <div id="collapseOneN" class="collapse" aria-labelledby="headWr"
                                                             data-parent="#accordionNotary">
                                                            <div id="docWR">{{ formWR }}</div>
                                                        </div>
                                                    </div>
                                                    <div class="card border-dark">
                                                        <div class="card-header" id="headDC">
                                                            <h2 class="mb-0">
                                                                <button class="btn btn-outline-secondary btn-lg btn-block"
                                                                        type="button" data-toggle="collapse"
                                                                        data-target="#collapseTwoN"
                                                                        aria-expanded="false"
                                                                        aria-controls="collapseTwoN">
                                                                    Documento certificado dominio:
                                                                </button>
                                                            </h2>
                                                        </div>
                                                        <div id="collapseTwoN" class="collapse" aria-labelledby="headDC"
                                                             data-parent="#accordionNotary">
                                                            <div id="docDC">{{ formDC }}</div>
                                                        </div>
                                                    </div>
                                                    <div class="card border-dark">
                                                        <div class="card-header" id="headPH">
                                                            <h2 class="mb-0">
                                                                <button class="btn btn-outline-secondary btn-lg btn-block"
                                                                        type="button" data-toggle="collapse"
                                                                        data-target="#collapseThreeN"
                                                                        aria-expanded="false"
                                                                        aria-controls="collapseThreeN">
                                                                    Documento de prohibiciones:
                                                                </button>
                                                            </h2>
                                                        </div>
                                                        <div id="collapseThreeN" class="collapse"
                                                             aria-labelledby="headPH"
                                                             data-parent="#accordionNotary">
                                                            <div id="docPH">{{ formPH }}</div>
                                                        </div>
                                                    </div>
                                                    <div class="card border-dark">
                                                        <div class="card-header" id="headEs">
                                                            <h2 class="mb-0">
                                                                <button class="btn btn-outline-secondary btn-lg btn-block"
                                                                        type="button" data-toggle="collapse"
                                                                        data-target="#collapseFourN"
                                                                        aria-expanded="false"
                                                                        aria-controls="collapseFourN">
                                                                    Documento de expropiación del SERVIU:
                                                                </button>
                                                            </h2>
                                                        </div>
                                                        <div id="collapseFourN" class="collapse"
                                                             aria-labelledby="headEs"
                                                             data-parent="#accordionNotary">
                                                            <div id="docEs">{{ formEs }}</div>
                                                        </div>
                                                    </div>
                                                    <button id="enviarNotaria" type="button" class="btn btn-success btn-lg btn-block">
                                                        Aceptar
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <p></p>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="card border-dark" id="Internos" style="display: none">
                                            <div class="card-header"><h3>Datos contables internos</h3></div>
                                            <div class="card-body">{{ formInternal.as_p }}
                                                <div class="accordion" id="accordionInternal">
                                                    <div class="card border-dark">
                                                        <div class="card-header" id="headTypeC">
                                                            <h2 class="mb-0">
                                                                <button class="btn btn-outline-secondary btn-lg btn-block"
                                                                        type="button"
                                                                        data-toggle="collapse"
                                                                        data-target="#collapseOneI"
                                                                        aria-expanded="true"
                                                                        aria-controls="collapseOneI">
                                                                    Documento Tipo de contrato:*
                                                                </button>
                                                            </h2>
                                                        </div>
                                                        <div id="collapseOneI" class="collapse"
                                                             aria-labelledby="headTypeC"
                                                             data-parent="#accordionInternal">
                                                            <div id="docTypeC">{{ formTypeC }}</div>
                                                        </div>
                                                    </div>
                                                    <div class="card border-dark">
                                                        <div class="card-header" id="headOther">
                                                            <h2 class="mb-0">
                                                                <button class="btn btn-outline-secondary btn-lg btn-block"
                                                                        type="button"
                                                                        data-toggle="collapse"
                                                                        data-target="#collapseTwoI"
                                                                        aria-expanded="false"
                                                                        aria-controls="collapseTwoI">
                                                                    Otro documento adicional:
                                                                </button>
                                                            </h2>
                                                        </div>
                                                        <div id="collapseTwoI" class="collapse"
                                                             aria-labelledby="headOther"
                                                             data-parent="#accordionInternal">
                                                            <div id="docOther">{{ formOther }}</div>
                                                        </div>
                                                    </div>
                                                    <button id="enviarInternos" type="button" class="btn btn-success btn-lg btn-block">
                                                        Aceptar
                                                    </button>
                                                </div>
                                            </div>
                                            <p></p>
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="card border-dark" id="SII" style="display: none">
                                            <div class="card-header"><h2>Datos de SII</h2></div>
                                            <div class="card-body">{{ formSII.as_p }}
                                                <div class="accordion" id="accordionSII">
                                                    <div class="card border-dark">
                                                        <div class="card-header" id="headAc">
                                                            <h2 class="mb-0">
                                                                <button class="btn btn-outline-secondary btn-lg btn-block"
                                                                        type="button"
                                                                        data-toggle="collapse"
                                                                        data-target="#collapseOneS"
                                                                        aria-expanded="true"
                                                                        aria-controls="collapseOneS">
                                                                    Documento de avalúo:
                                                                </button>
                                                            </h2>
                                                        </div>
                                                        <div id="collapseOneS" class="collapse" aria-labelledby="headAc"
                                                             data-parent="#accordionSII">
                                                            <div id="docAc">{{ formAc }}
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="card border-dark">
                                                        <div class="card-header" id="headDB">
                                                            <h2 class="mb-0">
                                                                <button class="btn btn-outline-secondary btn-lg btn-block"
                                                                        type="button"
                                                                        data-toggle="collapse"
                                                                        data-target="#collapseTwoS"
                                                                        aria-expanded="true"
                                                                        aria-controls="collapseTwoS">
                                                                    Documento de no deuda:
                                                                </button>
                                                            </h2>
                                                        </div>
                                                        <div id="collapseTwoS" class="collapse"
                                                             aria-labelledby="headAc"
                                                             data-parent="#accordionSII">
                                                            <div id="docDB">{{ formDB }}</div>
                                                        </div>
                                                    </div>
                                                    <button id="enviarSII" type="button" class="btn btn-success btn-lg btn-block">
                                                        Aceptar
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    </body>
    <script type="text/javascript">

        $(document).ready(function () {
            function getCookie(name) {
                var cookieValue = null;
                if (document.cookie && document.cookie != '') {
                    var cookies = document.cookie.split(';');
                    for (var i = 0; i < cookies.length; i++) {
                        var cookie = jQuery.trim(cookies[i]);

                        if (cookie.substring(0, name.length + 1) == (name + '=')) {
                            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                            break;
                        }
                    }
                }
                return cookieValue;
            }

            $("#enviarArquitecture").on("click", function () {
                alert('hola 1');
                var lista = [];
                $("#accordionArquitecture").find('input:file,input:text').each(function () {
                    $(this).val();
                    alert(lista);
                    lista.push(this.value);
                    alert(lista[0]);
                });
                $.ajax({
                    url: '{% url "add_acquisition" %}',
                    type: "POST",
                    data: {
                        csrfmiddlewaretoken: getCookie('csrftoken'),
                        'Tipo': "arquitecture",
                        'id': id,
                        'ground_surface': $("#ground_surface").val(),
                        'square_m_build': $("#square_m_build").val(),
                        'e_construction_m': $("#e_construction_m").val(),
                        'municipal_n': $("#municipal_n").val(),
                        'n_building_permit': $("#n_building_permit").val(),
                        'docEx': lista[0],
                    },
                    success: function () {
                        alert('Guardado');
                    }
                })
            });
            $("#enviarPropiedad").on("click", function () {
                var lista = [];
                $("#adquisicion").find('input:file').each(function () {
                    $(this).val();
                    alert(this.value);
                    lista.push(this.value);
                });
                $.ajax({
                    url: '{% url "add_acquisition" %}',
                    type: "POST",
                    data: {
                        csrfmiddlewaretoken: getCookie('csrftoken'),
                        'Tipo': "Propiedad",
                        'name': $("#name").val(),
                        'role_number': $("#role_number").val(),

                        'property_use': $("#property_use").val(),
                        'number_AASI': $("#number_AASI").val(),
                        'acquisition_date': $("#acquisition_date").val(),
                        'writing_data': $("#writing_data").val(),

                        'street': $("#street").val(),
                        'number': $("#number").val(),
                        'commune': $("#commune").val(),
                        'city': $("#city").val(),
                        'region': $("#region").val(),
                        'lot_number': $("#lot_number").val(),
                        'plot': $("#plot").val(),
                    },
                    success: function (id) {
                        const global_id = id;
                        $('#Arquitecture').show();
                        $('#Notary').show();
                        $('#Internos').show();
                        $('#SII').show();
                        $('#enviarPropiedad').hide();
                        alert(global_id);
                    }
                })

            });
            $("#enviarNotaria").on("click", function () {
                var lista = [];
                $("#accordionNotary").find('input:file,input:text').each(function () {
                    $(this).val();
                    alert(this.value);
                    lista.push(this.value)
                });
                $.ajax({
                    url: '{% url "add_acquisition" %}',
                    type: "POST",
                    data: {
                        csrfmiddlewaretoken: getCookie('csrftoken'),
                        'Tipo': "Notary",
                        'notary': $("#notary").val(),
                        'writing_year': $("#writing_year").val(),
                        'sale_price': $("#sale_price").val(),
                        'previous_title': $("#previous_title").val(),
                        'current_title': $("#current_title").val(),
                    },
                    success: function (id) {
                        const global_id = id;
                        alert(global_id);
                    }
                })
            });
            $("#enviarInternos").on("click", function () {
                var lista = [];
                $("#accordionInternal").find('input:file,input:text').each(function () {
                    $(this).val();
                    alert(this.value);
                    lista.push(this.value)
                });
                $.ajax({
                    url: '{% url "add_acquisition" %}',
                    type: "POST",
                    data: {
                        csrfmiddlewaretoken: getCookie('csrftoken'),
                        'Tipo': "Internal",
                        'value_land': $("#value_land").val(),
                        'value_construction': $("#value_construction").val(),
                        'acquiring_name': $("#sale_price").val(),
                        'supplier_name': $("#previous_title").val(),
                    },
                    success: function (id) {
                        const global_id = id;
                        alert(global_id);
                    }
                })
            })
            $("#enviarSII").on("click", function () {
                var lista = [];
                $("#accordionSII").find('input:file,input:text').each(function () {
                    $(this).val();
                    alert(this.value);
                    lista.push(this.value)
                });
                $.ajax({
                    url: '{% url "add_acquisition" %}',
                    type: "POST",
                    data: {
                        csrfmiddlewaretoken: getCookie('csrftoken'),
                        'Tipo': "SII",
                        'destiny': $("#destiny").val(),
                        'tax_appraisal': $("#tax_appraisal").val(),
                        'owner_name_SII': $("#owner_name_SII").val(),
                        'total_debt': $("#total_debt").val(),
                        'ex_contributions': $("#ex_contributions").val(),
                    },
                    success: function (id) {
                        const global_id = id;
                        alert(global_id);
                    }
                })
            })
        })
    </script>
{% endblock %}
</html>
